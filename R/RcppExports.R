# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

logical2Int <- function(idx) {
    .Call('diffr_logical2Int', PACKAGE = 'diffr', idx)
}

logical2Count <- function(vec, nthreads = 1L) {
    .Call('diffr_logical2Count', PACKAGE = 'diffr', vec, nthreads)
}

logRowSum <- function(mat, nthreads = 1L) {
    .Call('diffr_logRowSum', PACKAGE = 'diffr', mat, nthreads)
}

logSumVector <- function(vec, nthreads = 1L) {
    .Call('diffr_logSumVector', PACKAGE = 'diffr', vec, nthreads)
}

#' Group unique pairs from two vectors
#'
#' @param r first vector of integers. If elements are not integers, they will be
#'     casted to integers.
#' @param s second vector of integers. If elements are not integers, they will be
#'     casted to integers.
#' @return a list with the following items:
#'        \item{values}{unique and sorted values of \code{r} and \code{s}}
#'        \item{map}{a vector such that \code{cbind(r,s)[i,] = values[,map[i]]} for every i}
#' @export
mapToUniquePairs <- function(r, s) {
    .Call('diffr_mapToUniquePairs', PACKAGE = 'diffr', r, s)
}

mapToOriginal <- function(vec, map) {
    .Call('diffr_mapToOriginal', PACKAGE = 'diffr', vec, map)
}

#' Deconvolute bivariate count data in multiple enrichment regimes. Bivariate
#'  data is modeled as a mixture of binomial distributions. Fitting is done 
#'  with Expectation Maximization (EM).
#'
#' @param s \code{integer}-vector of counts (e.g. treatment counts in enrichment calls). 
#'     If elements are not integers, they will be casted to integers.
#' @param r \code{integer}-vector of counts (e.g. control counts in enrichment calls). 
#'     If elements are not integers, they will be casted to integers.
#' @param models \code{integer} specifying number of mixture components which should be 
#'     >= 2 (default=2).
#' @param eps \code{double} specifying termination criterion for EM fit (default=0.001).
#' @param verbose \code{logical} specifying if logging should be performed (default=FALSE).
#' @param nthreads \code{integer} specifying number of cores to use (default=1).
#' @return a list with the following items:
#'        \item{qstar}{naive enrichment ratio \code{s/(r + s)}. Basis for EM fit.}
#'        \item{theta}{Parametrization for \code{models} binomial distributiions}
#'        \item{prior}{Mixture proportions for \code{models} binomial distributiions}
#'        \item{posterior}{Posteriormatrix over all bins for \code{models} binomial distributiions}
#'        \item{lnL}{log likelihood trace}
#' @export
diffr_core <- function(r, s, models = 2L, eps = .0001, verbose = FALSE, nthreads = 1L) {
    .Call('diffr_diffr_core', PACKAGE = 'diffr', r, s, models, eps, verbose, nthreads)
}

